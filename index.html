<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;title&gt;Order Failure Training Arcade (Web)&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>body {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background: #000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>color: #00ff00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-family: "Courier New", monospace;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.crt {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>box-shadow: 0 0 20px #00ff00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border: 2px solid #00ff00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding: 10px 15px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.header {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>justify-content: space-between;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>align-items: flex-start;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin-bottom: 1px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-size: 14px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.title {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-weight: bold;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.status-line {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>gap: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-size: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.screen {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border-top: 1px solid #006600;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding-top: 6px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin-top: 4px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>white-space: pre-wrap;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>button {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background: #001900;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>color: #00ff00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border: 1px solid #00ff00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding: 4px 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin: 2px 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-family: "Courier New", monospace;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-size: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>button:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background: #004000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.option-row {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin: 4px 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.list-table {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border-collapse: collapse;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-size: 11px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin-top: 6px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.list-table th, .list-table td {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border: 1px solid #006600;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding: 2px 4px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.headline {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-weight: bold;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin: 4px 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.error-text {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>color: #00ff00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.warning {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>color: #ffcc00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.bad {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>color: #ff4444;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.good {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>color: #00ff00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.input-line {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin: 3px 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>input, select, textarea {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background: #000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>color: #00ff00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border: 1px solid #00ff00;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-family: "Courier New", monospace;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-size: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding: 2px 4px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>textarea {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.small {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-size: 11px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.center {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>text-align: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1">&lt;div class="crt"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div class="header"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="title"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>ORDER FAILURE TRAINING ARCADE – EXCHANGE EDITION (WEB)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div style="text-align: right;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div id="timerDisplay"&gt;TIME: 120s&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div class="small"&gt;Press [x] to go back&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div class="status-line"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="creditsDisplay"&gt;CREDITS: 3&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="scoreDisplay"&gt;SCORE: 0&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="scenarioDisplay"&gt;SCENARIO: -&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div id="screen" class="screen"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= DATA MODELS =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>class Address {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>constructor(name, dept, street, city, postCode, country, eid, ean, custShipTo, suppShipTo) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.name = name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.department = dept;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.street = street;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.city = city;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.postCode = postCode;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.country = country;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.eid = eid;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.ean = ean;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.customerShipToID = custShipTo;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.supplierShipToID = suppShipTo;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>class Organisation {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>constructor(name, buyerType, group, senderAddr, shipToAddr, billToAddr, folderName, addressList) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.name = name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.buyerType = buyerType; // Hospital | Pharmacy</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.group = group; <span class="Apple-converted-space">        </span>// Oracle | SBS | Powergate | Medecator | E-Direct</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.senderAddress = senderAddr;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.shipToAddress = shipToAddr;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.billToAddress = billToAddr;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.folderName = folderName;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.addressList = addressList || [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>class Scenario {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>constructor(id, description, poRef, dateTime, errorText, mappingType, senderOrg, supplierName, shipToId, billToId, correctAddress, correctContactEmail, correctContactSource) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.id = id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.description = description;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.poRef = poRef;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.dateTime = dateTime;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.errorText = errorText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.mappingType = mappingType; // "ShipToToEID", "ShipToToSupplierSpecific"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.senderOrg = senderOrg;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.supplierName = supplierName;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.shipToCustomerID = shipToId;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.billToCustomerID = billToId;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.correctAddress = correctAddress;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.correctContactEmail = correctContactEmail;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>this.correctContactSource = correctContactSource;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= GLOBAL GAME STATE =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const gameState = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>credits: 3,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>score: 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>currentScenarioIndex: -1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>scenarios: [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>currentScreen: 'intro',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenStack: [],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>timeLeft: 120,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>timerId: null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>supplierAccounts: [], // {supplierName, customerShipToID, supplierShipToID}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>customerReturnedSupplierShipTo: null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>emailWasRequired: false // for scenario 3</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= FAKE MASTER DATA =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const HospitalsFolder = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const PharmaciesFolder = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const SupplierDefinedAccounts = []; // per supplier: { supplierName, rows: [ { customerShipToID, supplierShipToID } ] }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function setupFakeData() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Orgs for scenarios</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const greenLeafAddrShip = new Address(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"GreenLeaf Pharmacy",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Dispensary",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"12 High Street",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"London",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NW1 4AB",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"987654321", <span class="Apple-converted-space">  </span>// EID</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"123456789012",// EAN</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PG123", <span class="Apple-converted-space">      </span>// CustomerShipTo</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"GLP-01" <span class="Apple-converted-space">      </span>// SupplierShipTo (not actually used in scenario 1)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const greenLeafAddrBill = new Address(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"GreenLeaf Pharmacy",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Accounts",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"99 Back Lane",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"London",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NW1 9CD",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"222222222",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"123456789099",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PG999",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"GLP-BILL"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const greenLeafSender = new Address(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"GreenLeaf Pharmacy",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Pharmacy Office",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"12 High Street",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"London",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NW1 4AB",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"", "", "", ""</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const greenLeafOrg = new Organisation(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"GreenLeaf Pharmacy",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Pharmacy",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Powergate",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>greenLeafSender,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>greenLeafAddrShip,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>greenLeafAddrBill,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"GreenLeaf Pharmacy",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>[greenLeafAddrShip, greenLeafAddrBill]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>PharmaciesFolder.push(greenLeafOrg);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const prostShipTo = new Address(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Westbridge Orthopaedic Centre",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Theatre Stores",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"45 Riverside Road",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Manchester",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"M10 2AB",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"555555555",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"555555555999",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"HSP777",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PUK-01-777"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const prostBillTo = new Address(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Westbridge Orthopaedic Centre",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Finance Dept",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"1 Admin Street",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Manchester",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"M10 1AA",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"666666666",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"666666666999",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"HSPBILL",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PUK-BILL-01"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const prostSender = new Address(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Westbridge Orthopaedic Centre",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Admin",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"1 Admin Street",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Manchester",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"M10 1AA",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"", "", "", ""</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const westbridgeOrg = new Organisation(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Westbridge Orthopaedic Centre",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Hospital",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Oracle",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>prostSender,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>prostShipTo,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>prostBillTo,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Westbridge Orthopaedic Centre",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>[prostShipTo, prostBillTo]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>HospitalsFolder.push(westbridgeOrg);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const nhsShip = new Address(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHS Trust A",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Central Stores",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"200 Supply Road",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Birmingham",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"B11 3CD",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"999111222",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"777777777001",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHS01",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"" // Supplier shipto missing initially</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const nhsBill = new Address(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHS Trust A",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Finance",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"1 Finance Way",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Birmingham",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"B11 1AA",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"999111333",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"777777777002",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHSB01",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>""</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const nhsSender = new Address(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHS Trust A",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Admin",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"1 Admin Way",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Birmingham",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"B11 1ZZ",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"", "", "", ""</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const nhsOrg = new Organisation(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHS Trust A",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Hospital",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"SBS",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>nhsSender,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>nhsShip,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>nhsBill,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHS Trust A",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>[nhsShip, nhsBill]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>HospitalsFolder.push(nhsOrg);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Supplier defined accounts</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>SupplierDefinedAccounts.push({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>supplierName: "Prosthetics UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>rows: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{ customerShipToID: "HSP777", supplierShipToID: "PUK-01-777" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{ customerShipToID: "HSP888", supplierShipToID: "PUK-02-888" }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>SupplierDefinedAccounts.push({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>supplierName: "NHS Supply Chain",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>rows: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{ customerShipToID: "NHSX00", supplierShipToID: "NSC-OLD-01" }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// NOTE: no NHS01 yet – user must add after email</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>SupplierDefinedAccounts.push({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>supplierName: "PharmaSupply Ltd",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>rows: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{ customerShipToID: "PG555", supplierShipToID: "PSL-555" }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Scenarios</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc1 = new Scenario(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>1,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Powergate pharmacy: CustomerSpecificShipTo → EID missing.",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PG-PO-10001",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"2025/11/28 09:30",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"CustomerSpecificShipTo {PG123} to EID (null) missing.",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ShipToToEID",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>greenLeafOrg,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Powergate Central",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PG123",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PG999",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>greenLeafAddrShip,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"greenleaf-edi@customer.org",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"BoardingSheet"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc2 = new Scenario(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>2,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Hospital: CustomerSpecificShipTo → SupplierSpecificShipTo missing (mapping exists in Supplier Defined Accounts).",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"HOSP-PO-777",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"2025/11/28 11:05",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"CustomerSpecificShipTo {HSP777} to SupplierSpecificShipTo (null) missing.",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ShipToToSupplierSpecific",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>westbridgeOrg,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Prosthetics UK",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"HSP777",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"HSPBILL",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>prostShipTo,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"westbridge-edi@customer.org",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"BoardingSheet"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc3 = new Scenario(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>3,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHS Supply Chain: CustomerSpecificShipTo → SupplierSpecificShipTo missing (not on Supplier Defined Accounts; must contact sender).",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHS-PO-01",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"2025/11/28 15:43",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"CustomerSpecificShipTo {NHS01} to SupplierSpecificShipTo (null) missing.",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ShipToToSupplierSpecific",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>nhsOrg,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHS Supply Chain",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHS01",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"NHSB01",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>nhsShip,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"nhs-trust-a-edi@customer.org",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Salesforce"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.scenarios = [sc1, sc2, sc3];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Pre-populate supplierAccounts with existing rows</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>SupplierDefinedAccounts.forEach(set =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>set.rows.forEach(row =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>gameState.supplierAccounts.push({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>supplierName: set.supplierName,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>customerShipToID: row.customerShipToID,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>supplierShipToID: row.supplierShipToID</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= RENDER HELPERS =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function updateHeader() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('creditsDisplay').textContent = `CREDITS: ${gameState.credits}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('scoreDisplay').textContent = `SCORE: ${gameState.score}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const scNum = gameState.currentScenarioIndex &gt;= 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>? (gameState.currentScenarioIndex + 1)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>: '-';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('scenarioDisplay').textContent = `SCENARIO: ${scNum}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('timerDisplay').textContent = `TIME: ${gameState.timeLeft}s`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function setScreen(html) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const div = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>div.innerHTML = html;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>updateHeader();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function pushScreen(newScreen) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (gameState.currentScreen) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>gameState.screenStack.push(gameState.currentScreen);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.currentScreen = newScreen;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function goBack() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (gameState.screenStack.length === 0) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const prev = gameState.screenStack.pop();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.currentScreen = prev;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>renderCurrentScreen();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= TIMER =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function resetTimer() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.timeLeft = 120;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (gameState.timerId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>clearInterval(gameState.timerId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.timerId = setInterval(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>gameState.timeLeft--;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>updateHeader();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (gameState.timeLeft &lt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>clearInterval(gameState.timerId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>onTimeUp();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}, 1000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function onTimeUp() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.credits--;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>updateHeader();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (gameState.credits &lt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>showGameOver("TIME'S UP! You ran out of credits.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>setScreen(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>"TIME'S UP!\n\nYou did not complete this scenario in time.\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>"You lose 1 credit.\n\nPress the button below to continue to the next scenario."</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const btn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>btn.textContent = "Next scenario";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>btn.onclick = () =&gt; nextScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>document.getElementById('screen').appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>document.getElementById('screen').appendChild(btn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= MAIN FLOW =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showIntro() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.currentScreen = 'intro';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.screenStack = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (gameState.timerId) clearInterval(gameState.timerId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.timeLeft = 120;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>updateHeader();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const ascii = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"%%%%%**+++###***%***%%%%%%*%%%%%",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"%%%%****%#@@@#%%%%*%%%++%##*++*+",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"###%%*++#*+%##%*+++==++++*%%++*+",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"+*+===+=----=+==+=+=+++**##*++=+",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"*++=----....:-=+++++****#%+=--=+",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"++==--::::..::-===+***###*=--:::",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"*++*+==--::::--=+**##%%%#+=---::",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"**%%##*+=--:::--==+*#%%%#*+=--::"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>].join("\n");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const html =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"============================================================\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"=<span class="Apple-converted-space">                                                          </span>=\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"=<span class="Apple-converted-space">  </span>ORDER FAILURE TRAINING ARCADE - EXCHANGE EDITION (WEB)<span class="Apple-converted-space">  </span>=\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"=<span class="Apple-converted-space">                                                          </span>=\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"============================================================\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>ascii + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"WANT TO PLAY? IT IS VERY NICE!\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"CREDITS: " + gameState.credits + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"► START\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>VIEW INSTRUCTIONS\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>EXIT\n\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(html);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const startBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>startBtn.textContent = "START";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>startBtn.onclick = () =&gt; startGame();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const helpBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>helpBtn.textContent = "VIEW INSTRUCTIONS";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>helpBtn.onclick = () =&gt; showInstructions();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const exitBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>exitBtn.textContent = "EXIT";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>exitBtn.onclick = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>setScreen("Thanks for playing.\n\nClose the browser tab to exit.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(startBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(helpBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(exitBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showInstructions() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('instructions');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"INSTRUCTIONS\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"You will see failed order scenarios from the Exchange.\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Your job:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>- Read the error message\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>- Decide where to look for the missing data\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>- Navigate through Shared Drive / SharePoint\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>- Check boarding sheets, GLN Calculator, Supplier Defined Accounts\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>- Contact the customer ONLY when appropriate\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>- Finally, build the correct mapping and process the order.\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Special rules:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>- If the correct SupplierSpecificShipTo exists in the Supplier Defined\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">    </span>Accounts list and you email the customer instead, you FAIL.\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>- In Scenario 3, the SupplierSpecificShipTo is NOT in the list.\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">    </span>You must email the customer, get the new ID, and add it to the\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">    </span>Supplier Defined Accounts BEFORE processing the order.\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>- You have 2 minutes per scenario.\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>- You have 3 credits total.\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Use [x] at any time to go back to the previous screen.\n\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const btn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.textContent = "Back";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.onclick = () =&gt; goBack();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('screen').appendChild(btn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function startGame() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.score = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.credits = 3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.currentScenarioIndex = -1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.screenStack = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.customerReturnedSupplierShipTo = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.emailWasRequired = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>nextScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function nextScenario() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.currentScenarioIndex++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.customerReturnedSupplierShipTo = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.emailWasRequired = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (gameState.currentScenarioIndex &gt;= gameState.scenarios.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>showFinalResults();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>resetTimer();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>showErrorScreen();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showFinalResults() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (gameState.timerId) clearInterval(gameState.timerId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.currentScreen = 'final';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const html =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"FINAL RESULTS\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"-------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Score: <span class="Apple-converted-space">  </span>" + gameState.score + " / " + gameState.scenarios.length + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Credits: " + gameState.credits + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>(gameState.credits &gt; 0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>? "TRAINING RUN COMPLETE. PRESS RESTART TO PLAY AGAIN.\n\n"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>: "GAME OVER. INSERT COIN (OR REFRESH) TO TRY AGAIN.\n\n");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(html);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const btn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.textContent = "Restart";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.onclick = () =&gt; startGame();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(btn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showGameOver(message) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (gameState.timerId) clearInterval(gameState.timerId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.currentScreen = 'gameOver';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const html =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"GAME OVER\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"---------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>message + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Press Restart to play again.\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(html);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const btn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.textContent = "Restart";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.onclick = () =&gt; startGame();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('screen').appendChild(btn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= SCREENS =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function getCurrentScenario() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return gameState.scenarios[gameState.currentScenarioIndex];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showErrorScreen() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('error');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ERROR SCREEN\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Scenario " + sc.id + ": " + sc.description + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PO:<span class="Apple-converted-space">        </span>" + sc.poRef + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Date/Time: " + sc.dateTime + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Order Failure:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>" + sc.errorText + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Press 'Continue' to see your options.\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const btn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.textContent = "Continue to options";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.onclick = () =&gt; showMappingMenu();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('screen').appendChild(btn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showMappingMenu() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('mappingMenu');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"MAPPING MENU\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Error:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>" + sc.errorText + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"What do you want to do?\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>1) Check boarding sheet\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>2) Check further (codelookups / GLN / Supplier Defined Accounts)\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>3) Contact customer\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>4) Show more details\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>5) Try to process order\n\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b1 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b1.textContent = "1) Check boarding sheet";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b1.onclick = () =&gt; showBoardingSheetRoot();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b1); screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b2 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b2.textContent = "2) Check further (codelookups / GLN / Supplier Defined Accounts)";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b2.onclick = () =&gt; showCheckFurther();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b2); screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b3 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b3.textContent = "3) Contact customer";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b3.onclick = () =&gt; showContactCustomer();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b3); screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b4 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b4.textContent = "4) Show more details";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b4.onclick = () =&gt; showMoreDetails();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b4); screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b5 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b5.textContent = "5) Try to process order";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b5.onclick = () =&gt; showProcessOrderScreen();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b5);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showMoreDetails() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('details');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const s = sc.senderOrg;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ORDER DETAILS\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"-------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Sender Name <span class="Apple-converted-space">  </span>: " + s.name + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Supplier Name : " + sc.supplierName + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Group <span class="Apple-converted-space">        </span>: " + s.group + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Sender Address:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>formatAddressBlock(s.senderAddress, false) + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ShipTo Address (from order details):\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>formatAddressBlock(s.shipToAddress, true, sc.mappingType) + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"BillTo Address:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>formatAddressBlock(s.billToAddress, true, sc.mappingType) + "\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const btn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.textContent = "Back to mapping menu";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.onclick = () =&gt; goBack();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('screen').appendChild(btn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function formatAddressBlock(addr, includeIds, mappingType) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!addr) return "<span class="Apple-converted-space">  </span>(no address)";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let out = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (addr.department) out += "<span class="Apple-converted-space">  </span>Department : " + addr.department + "\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>out += "<span class="Apple-converted-space">  </span>Street <span class="Apple-converted-space">    </span>: " + addr.street + "\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>out += "<span class="Apple-converted-space">  </span>City <span class="Apple-converted-space">      </span>: " + addr.city + "\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>out += "<span class="Apple-converted-space">  </span>PostCode <span class="Apple-converted-space">  </span>: " + addr.postCode + "\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>out += "<span class="Apple-converted-space">  </span>Country<span class="Apple-converted-space">    </span>: " + addr.country + "\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (includeIds) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>out += "\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (mappingType === "ShipToToSupplierSpecific") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Hide supplierSpecific for these scenarios: must be discovered or created</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>out += "<span class="Apple-converted-space">  </span>EID <span class="Apple-converted-space">            </span>: " + (addr.eid || "") + "\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>out += "<span class="Apple-converted-space">  </span>EAN <span class="Apple-converted-space">            </span>: " + (addr.ean || "") + "\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>out += "<span class="Apple-converted-space">  </span>SupplierSpecific: " + "(not visible – mapping missing)\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>out += "<span class="Apple-converted-space">  </span>EID <span class="Apple-converted-space">            </span>: " + (addr.eid || "") + "\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>out += "<span class="Apple-converted-space">  </span>EAN <span class="Apple-converted-space">            </span>: " + (addr.ean || "") + "\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>out += "<span class="Apple-converted-space">  </span>SupplierSpecific: " + (addr.supplierShipToID || "") + "\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return out;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= BOARDING SHEET FLOW =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showBoardingSheetRoot() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('boardingRoot');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"BOARDING SHEET – ROOT\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"----------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Root:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>1) Shared Drive\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>2) SharePoint\n\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b1 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b1.textContent = "1) Shared Drive";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b1.onclick = () =&gt; showSharedDriveFolders();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b1); screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b2 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b2.textContent = "2) SharePoint (E-Direct / Supplier Defined Accounts)";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b2.onclick = () =&gt; showSharePointRoot();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showSharedDriveFolders() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('sharedFolders');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"SHARED DRIVE\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Parent Shared Drive:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>1) Hospitals\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>2) Pharmacies\n\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b1 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b1.textContent = "1) Hospitals";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b1.onclick = () =&gt; showOrgList("Hospitals", HospitalsFolder);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b2 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b2.textContent = "2) Pharmacies";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b2.onclick = () =&gt; showOrgList("Pharmacies", PharmaciesFolder);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b1); screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showOrgList(folderName, folderList) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('orgList');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"FOLDER: " + folderName.toUpperCase() + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"---------------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Select an organisation boarding sheet:\n\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>folderList.forEach((org, idx) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const btn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>btn.textContent = (idx + 1) + ") " + org.folderName;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>btn.onclick = () =&gt; showOrgAddressList(org);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(btn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showOrgAddressList(org) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('orgAddressList');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ADDRESS LIST – " + org.folderName + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"----------------------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Name | Department | Street | City | PostCode | Country | EID | EAN | CustShipTo | SuppShipTo\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"-------------------------------------------------------------------------------------------\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const table = document.createElement('table');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>table.className = 'list-table';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const thead = document.createElement('thead');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const trh = document.createElement('tr');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>["Name", "Department", "Street", "City", "PostCode", "Country",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"EID", "EAN", "CustomerShipToID", "SupplierShipToID"].forEach(h =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const th = document.createElement('th');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>th.textContent = h;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>trh.appendChild(th);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>thead.appendChild(trh);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>table.appendChild(thead);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const tbody = document.createElement('tbody');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>org.addressList.forEach((a, idx) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const tr = document.createElement('tr');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>[a.name, a.department, a.street, a.city, a.postCode, a.country,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>a.eid, a.ean, a.customerShipToID, a.supplierShipToID].forEach(val =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const td = document.createElement('td');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>td.textContent = val;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>tr.appendChild(td);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>tbody.appendChild(tr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>table.appendChild(tbody);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(table);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const note = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>note.className = "small";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>note.textContent = "Check address + GLN/EID here. The correct EID / supplier-specific ID will match your sender and ShipTo.";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(note);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const backBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>backBtn.textContent = "Back";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>backBtn.onclick = () =&gt; goBack();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(backBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= CHECK FURTHER / SUPPLIER DEFINED / GLN =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showCheckFurther() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('checkFurther');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"CHECK CODELOOKUPS / GLN / SUPPLIER DEFINED ACCOUNTS\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"----------------------------------------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"You inspect the current codelookups for this sender:\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"From CustomerSpecificShipTo {" + sc.shipToCustomerID + "} To SupplierSpecificShipTo<span class="Apple-converted-space">  </span>(maybe?)\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"From CustomerSpecificBillTo {" + sc.billToCustomerID + "} To SupplierSpecificBillTo (maybe?)\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"From CustomerSpecificShipTo {" + sc.shipToCustomerID + "} To EID\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"From CustomerSpecificBillTo {" + sc.billToCustomerID + "} To EID\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"From CustomerSpecificShipTo {" + sc.shipToCustomerID + "} To EANLocation\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"From CustomerSpecificBillTo {" + sc.billToCustomerID + "} To EANLocation\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Next step:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>1) View GLN Calculator\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>2) View Supplier Defined Accounts\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>3) Back to mapping menu\n\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b1 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b1.textContent = "1) GLN Calculator (SharePoint)";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b1.onclick = () =&gt; showGLNCalculator();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b2 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b2.textContent = "2) Supplier Defined Accounts (SharePoint)";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b2.onclick = () =&gt; showSupplierDefinedRoot();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b3 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b3.textContent = "3) Back";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b3.onclick = () =&gt; goBack();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b1); screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b2); screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b3);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showSharePointRoot() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('sharePointRoot');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"SHAREPOINT ROOT\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"----------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Parent SharePoint:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>1) E-Direct MasterSheet\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>2) SupplierDefined Accounts\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>3) GLN Calculator\n\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b1 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b1.textContent = "1) E-Direct MasterSheet";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b1.onclick = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>setScreen("E-Direct MasterSheet.xlsx\n\n(Here you'd see a list of Peppol-based buyers.)\n\nUse Shared Drive for standard boarding sheets.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const backBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>backBtn.textContent = "Back";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>backBtn.onclick = () =&gt; goBack();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>document.getElementById('screen').appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>document.getElementById('screen').appendChild(backBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b2 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b2.textContent = "2) SupplierDefined Accounts";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b2.onclick = () =&gt; showSupplierDefinedRoot();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const b3 = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b3.textContent = "3) GLN Calculator";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>b3.onclick = () =&gt; showGLNCalculator();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b1); screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b2); screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(b3);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showGLNCalculator() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('glnCalc');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"GLN CALCULATOR\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"---------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"GLN Calculator.xlsx\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Org Name | Department Name | GLN<span class="Apple-converted-space">        </span>| Date <span class="Apple-converted-space">      </span>| Assigned By\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"------------------------------------------------------------------\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"1) " + sc.senderOrg.name + " | " + sc.senderOrg.shipToAddress.department + " | " + sc.senderOrg.shipToAddress.ean + " | 2025-10-01 | Alice\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"2) (empty) | (empty) | 555666777888 | (empty) | (empty)\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Some rows only have GLN. You must fill details to use them.\n\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const info = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>info.className = 'small';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>info.textContent = "In Scenario 1 this helps you confirm that the GLN matches the boarding sheet.";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(info);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const backBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>backBtn.textContent = "Back";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>backBtn.onclick = () =&gt; goBack();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(backBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showSupplierDefinedRoot() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('supplierDefinedRoot');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"SUPPLIER DEFINED ACCOUNTS – ROOT\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"---------------------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Folder: SupplierDefined Accounts\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Pick a supplier workbook:\n\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>SupplierDefinedAccounts.forEach((set, idx) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const btn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>btn.textContent = (idx + 1) + ") " + set.supplierName + ".xlsx";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>btn.onclick = () =&gt; showSupplierDefinedList(set);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(btn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showSupplierDefinedList(set) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('supplierDefinedList');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"SUPPLIER DEFINED ACCOUNTS – " + set.supplierName + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"----------------------------------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"CustomerShipToID | SupplierShipToID\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"-----------------------------------\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const table = document.createElement('table');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>table.className = 'list-table';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const thead = document.createElement('thead');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const trh = document.createElement('tr');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>["CustomerShipToID", "SupplierShipToID"].forEach(h =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const th = document.createElement('th');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>th.textContent = h;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>trh.appendChild(th);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>thead.appendChild(trh);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>table.appendChild(thead);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const tbody = document.createElement('tbody');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>set.rows.forEach(row =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const tr = document.createElement('tr');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const td1 = document.createElement('td');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>td1.textContent = row.customerShipToID;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const td2 = document.createElement('td');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>td2.textContent = row.supplierShipToID;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>tr.appendChild(td1); tr.appendChild(td2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>tbody.appendChild(tr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>table.appendChild(tbody);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(table);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const info = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>info.className = 'small';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>info.textContent = "If the error is SupplierSpecificShipTo or SupplierSpecificBillTo you must check here before contacting the customer.";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(info);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const addBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>addBtn.textContent = "Add new mapping";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>addBtn.onclick = () =&gt; showAddSupplierMapping(set);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(addBtn);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const backBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>backBtn.textContent = "Back";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>backBtn.onclick = () =&gt; goBack();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(backBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showAddSupplierMapping(set) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('addSupplierMapping');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ADD NEW SUPPLIER DEFINED MAPPING – " + set.supplierName + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"----------------------------------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Enter:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>CustomerShipToID\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>SupplierShipToID\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Hint: In Scenario 3 the customer will reply with a new SupplierShipToID\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">      </span>like 'Q34M35' that must be added here for NHS Supply Chain.\n\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const divForm = document.createElement('div');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const line1 = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>line1.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>line1.innerHTML = 'CustomerShipToID: &lt;input id="custShipInput" value="' + sc.shipToCustomerID + '"&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const line2 = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>line2.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>line2.innerHTML = 'SupplierShipToID: &lt;input id="suppShipInput" value=""&gt;';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>divForm.appendChild(line1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>divForm.appendChild(line2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(divForm);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const saveBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>saveBtn.textContent = "Save mapping";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>saveBtn.onclick = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const cust = document.getElementById('custShipInput').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const supp = document.getElementById('suppShipInput').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!cust || !supp) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>alert("Both values are required.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>set.rows.push({ customerShipToID: cust, supplierShipToID: supp });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>gameState.supplierAccounts.push({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>supplierName: set.supplierName,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>customerShipToID: cust,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>supplierShipToID: supp</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>alert("Mapping saved.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>goBack(); // back to list</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(saveBtn);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const backBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>backBtn.textContent = "Back";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>backBtn.onclick = () =&gt; goBack();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(backBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= CONTACT CUSTOMER + EMAIL =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showContactCustomer() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('contactRoot');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"CONTACT CUSTOMER\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"----------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Where do you want to look for the email address?\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>a) Boarding sheet\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>b) Salesforce\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>c) EDI document\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>d) Exchange Contact Users\n\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const mkBtn = (label, fn) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const b = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b.textContent = label;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b.onclick = fn;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(b);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>mkBtn("a) Boarding sheet", () =&gt; chooseEmailFromBoardingSheet());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>mkBtn("b) Salesforce", () =&gt; chooseEmailFromSalesforce());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>mkBtn("c) EDI document", () =&gt; chooseEmailFromEdi());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>mkBtn("d) Exchange Contact Users", () =&gt; chooseEmailFromExchange());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function chooseEmailFromBoardingSheet() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('contactBoarding');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const good = sc.correctContactEmail;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const bad = "stmaryshospital@s.c";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const otherBuyer = "wronghospital@customer.org";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"BOARDING SHEET CONTACTS\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"------------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"You open the boarding sheet and see:\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>1) " + sc.senderOrg.name + " EDI Contact &lt;" + good + "&gt;\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>2) " + sc.senderOrg.name + " Old Contact &lt;" + bad + "&gt;\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>3) Other Hospital Contact &lt;" + otherBuyer + "&gt;\n\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>[good, bad, otherBuyer].forEach((email, idx) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const b = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b.textContent = "Pick " + (idx + 1) + ") " + email;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b.onclick = () =&gt; composeEmail(email);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(b);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function chooseEmailFromSalesforce() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('contactSalesforce');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const good = sc.correctContactEmail;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const other = "supplier-support@somevendor.com";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"SALESFORCE SEARCH\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"You search Salesforce for: " + sc.senderOrg.name + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Results:\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>1) " + sc.senderOrg.name + " - EDI Coordinator &lt;" + good + "&gt;\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>2) Supplier Contact &lt;" + other + "&gt;\n\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>[good, other].forEach((email, idx) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const b = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b.textContent = "Pick " + (idx + 1) + ") " + email;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b.onclick = () =&gt; composeEmail(email);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(b);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function chooseEmailFromEdi() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('contactEdi');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const good = sc.correctContactEmail;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const bad = "stmaryshospital@s.c";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"RAW EDI DOCUMENT\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"-----------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"DOC-SENDER: " + sc.senderOrg.name + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"CONTACT1: " + bad + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"CONTACT2: " + good + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Which email do you trust and copy?\n\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>[bad, good].forEach((email, idx) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const b = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b.textContent = "Pick " + (idx + 1) + ") " + email;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b.onclick = () =&gt; composeEmail(email);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(b);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function chooseEmailFromExchange() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('contactExchange');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const good = sc.correctContactEmail;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const wrong = "othertrust-edi@customer.org";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"EXCHANGE CONTACT USERS\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"-----------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>1) " + sc.senderOrg.name + " EDI User &lt;" + good + "&gt;\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>2) Other Trust EDI &lt;" + wrong + "&gt;\n\n";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>[good, wrong].forEach((email, idx) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const b = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b.textContent = "Pick " + (idx + 1) + ") " + email;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>b.onclick = () =&gt; composeEmail(email);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(b);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function composeEmail(initialEmail) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('email');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"SEND EMAIL\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"----------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Pre-composed email:\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"To: " + initialEmail + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Dear customer,\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Could you please provide the shipto/billto ID {???} for this order?\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ShipTo/BillTo ID: {???}\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PO Number: {???}\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Supplier: {???}\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Address: {???}\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Now fill in the missing pieces correctly.\n\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const form = document.createElement('div');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const lineTo = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lineTo.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lineTo.innerHTML = 'To: &lt;input id="emailTo" value="' + initialEmail + '" size="40"&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(lineTo);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const lineType = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lineType.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lineType.innerHTML = 'Type of ID (shipto/billto): &lt;input id="idType" value="shipto"&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(lineType);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const lineIdVal = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lineIdVal.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lineIdVal.innerHTML = 'ShipTo/BillTo ID value: &lt;input id="idVal" value="' + sc.shipToCustomerID + '"&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(lineIdVal);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const linePo = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>linePo.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>linePo.innerHTML = 'PO Number: &lt;input id="poVal" value="' + sc.poRef + '"&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(linePo);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const lineSup = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lineSup.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lineSup.innerHTML = 'Supplier name: &lt;input id="supVal" value="' + sc.supplierName + '"&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(lineSup);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const lineAddr = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lineAddr.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lineAddr.innerHTML = 'Address (Street only): &lt;input id="addrVal" value="' + sc.correctAddress.street + '" size="40"&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(lineAddr);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(form);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sendBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>sendBtn.textContent = "Send email";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>sendBtn.onclick = () =&gt; evaluateEmail(sc);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(sendBtn);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const backBtn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>backBtn.textContent = "Back";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>backBtn.onclick = () =&gt; goBack();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(document.createElement('br'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(backBtn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function evaluateEmail(sc) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const toEmail = document.getElementById('emailTo').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const idType = document.getElementById('idType').value.trim().toLowerCase();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const idVal = document.getElementById('idVal').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const poVal = document.getElementById('poVal').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const supVal = document.getElementById('supVal').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const addrVal = document.getElementById('addrVal').value.trim();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const correctIdType = "shipto"; // all our scenarios right now are shipto-based</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const correctIdVal = sc.shipToCustomerID;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const correctStreet = sc.correctAddress.street;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const emailOk =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>toEmail.toLowerCase() === sc.correctContactEmail.toLowerCase() &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>idType === correctIdType &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>idVal === correctIdVal &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>poVal === sc.poRef &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>supVal === sc.supplierName &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>addrVal === correctStreet;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!emailOk) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>alert("Your email is missing or has incorrect information. You don't get a useful reply.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>goBack();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Special rule: if mapping is SupplierSpecificShipTo AND mapping already exists,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// emailing customer is a FAIL (scenario 2).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (sc.mappingType === "ShipToToSupplierSpecific") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const exists = findSupplierAccount(sc.supplierName, sc.shipToCustomerID);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (exists) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>alert("BIG WARNING:\nYou emailed the customer for a supplier-specific ID that already exists in Supplier Defined Accounts.\nYou failed this scenario.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>gameState.credits--;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (gameState.credits &lt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>showGameOver("You failed to check Supplier Defined Accounts before contacting the customer.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>nextScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Scenario 3: customer returns new ID "Q34M35"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (sc.id === 3) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>gameState.customerReturnedSupplierShipTo = "Q34M35";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>gameState.emailWasRequired = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>alert("Customer reply:\n\n\"Dear team, please use Q34M35 and reprocess order. Thanks\"");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>alert("Customer replies immediately with the information you need.\nYou can now complete the mapping.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>goBack(); // back towards contact menu / mapping</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function findSupplierAccount(supplierName, customerShipToID) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return gameState.supplierAccounts.find(a =&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>a.supplierName === supplierName &amp;&amp; a.customerShipToID === customerShipToID</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= PROCESS ORDER / MAPPING =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function showProcessOrderScreen() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>pushScreen('process');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const wrongFrom = (sc.senderOrg.buyerType === "Pharmacy" ? "Some Other Pharmacy" : "Other NHS Trust");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const wrongTo = (sc.supplierName === "Prosthetics UK" ? "Random Pharma Ltd" : "Prosthetics UK");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let text =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PROCESS ORDER – BUILD LOOKUP\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"----------------------------\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"PO: " + sc.poRef + " <span class="Apple-converted-space">  </span>Date/Time: " + sc.dateTime + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"Error: " + sc.errorText + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ORDER DETAILS (FROM):\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>Sender: <span class="Apple-converted-space">  </span>" + sc.senderOrg.name + "\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>ShipToID: " + sc.shipToCustomerID + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"ORDER DETAILS (TO):\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"<span class="Apple-converted-space">  </span>Supplier: " + sc.supplierName + "\n\n" +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"MAPPING INPUT:\n\n";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setScreen(text);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const screenDiv = document.getElementById('screen');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const form = document.createElement('div');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const fromLine = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>fromLine.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>fromLine.innerHTML = 'From (organisation): &lt;input id="fromName" value="' + wrongFrom + '" size="30"&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const toLine = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>toLine.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>toLine.innerHTML = 'To <span class="Apple-converted-space">  </span>(supplier):<span class="Apple-converted-space">      </span>&lt;input id="toName" value="' + wrongTo + '" size="30"&gt;';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(fromLine);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(toLine);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const lookupLine = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lookupLine.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lookupLine.innerHTML =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'Type of lookup: &lt;select id="lookupType"&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option value="Main"&gt;Main&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option value="ShipTo" selected&gt;ShipTo&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option value="BillTo"&gt;BillTo&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;/select&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(lookupLine);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const fromQLine = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>fromQLine.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>fromQLine.innerHTML =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'FROM qualifier: &lt;select id="fromQualifier"&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option&gt;From EID&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option&gt;From EanLocation&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option selected&gt;From CustomerSpecificShipTo&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option&gt;From CustomerSpecificBillTo&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option&gt;From SupplierSpecificShipTo&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option&gt;From SupplierSpecificBillTo&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;/select&gt; ' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'Value: &lt;input id="fromValue" value="' + sc.shipToCustomerID + '"&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(fromQLine);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const toQLine = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>toQLine.className = 'input-line';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>toQLine.innerHTML =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'TO qualifier: &lt;select id="toQualifier"&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option&gt;To EID&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option&gt;To EanLocation&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option&gt;To CustomerSpecificShipTo&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option&gt;To CustomerSpecificBillTo&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option selected&gt;To SupplierSpecificShipTo&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;option&gt;To SupplierSpecificBillTo&lt;/option&gt;' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'&lt;/select&gt; ' +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>'Value: &lt;input id="toValue" value=""&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.appendChild(toQLine);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(form);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const btn = document.createElement('button');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.textContent = "Re-process order";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.onclick = () =&gt; evaluateMapping();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>screenDiv.appendChild(btn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function evaluateMapping() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sc = getCurrentScenario();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const fromName = document.getElementById('fromName').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const toName = document.getElementById('toName').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const lookupType = document.getElementById('lookupType').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const fromQualifier = document.getElementById('fromQualifier').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const fromValue = document.getElementById('fromValue').value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const toQualifier = document.getElementById('toQualifier').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const toValue = document.getElementById('toValue').value.trim();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let namesOk =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>fromName.toLowerCase() === sc.senderOrg.name.toLowerCase() &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>toName.toLowerCase() === sc.supplierName.toLowerCase();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let lookupTypeOk = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (sc.mappingType === "ShipToToEID" || sc.mappingType === "ShipToToSupplierSpecific") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>lookupTypeOk = (lookupType === "ShipTo");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>lookupTypeOk = (lookupType === "BillTo");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let fromOk =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>fromQualifier === "From CustomerSpecificShipTo" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>fromValue === sc.shipToCustomerID;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let toOk = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (sc.mappingType === "ShipToToEID") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>toOk = (toQualifier === "To EID" &amp;&amp; toValue === sc.correctAddress.eid);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else if (sc.mappingType === "ShipToToSupplierSpecific") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// For SupplierSpecific, must align with Supplier Defined Accounts</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const acc = findSupplierAccount(sc.supplierName, sc.shipToCustomerID);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (!acc) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>alert("Order still failing: Supplier Defined Account for this ShipTo is missing.\nDid you forget to add it after contacting the customer?");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>failScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>toOk = (toQualifier === "To SupplierSpecificShipTo" &amp;&amp;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>toValue === acc.supplierShipToID);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!namesOk || !lookupTypeOk || !fromOk || !toOk) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>failScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>succeedScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function failScenario() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.credits--;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (gameState.credits &lt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>showGameOver("Order still failing. You ran out of credits.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>alert("Result: ORDER STILL FAILING.\nYou lost a credit. Credits left: " + gameState.credits);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>nextScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function succeedScenario() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>gameState.score++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>alert("Result: ORDER SUCCESSFULLY PROCESSED!\n\nGood job.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>nextScenario();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= KEYBOARD HANDLER =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>document.addEventListener('keydown', (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (e.key === 'x' || e.key === 'X') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>goBack();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// ========= INIT =========</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>function init() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setupFakeData();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>showIntro();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>init();</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
